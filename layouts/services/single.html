{{ define "main" }}
  <section class="py-16">
    <div class="container mx-auto px-4">
      {{ with .Title }}
        <h2 class="text-primary mb-12 text-center text-6xl font-bold">{{ . }}</h2>
      {{ end }}
      <div class="mb-12 text-center">
        <a href="/book-service" id="checkout-button" class="bg-primary hover:bg-primary/80 rounded px-8 py-2 text-white duration-500 mx-auto">Book Now</a>
      </div>
      {{ with .Content }}
        <div class="prose prose-lg mx-auto">
          {{ . }}
        </div>
      {{ end }}
    </div>
  </section>
  
  
    <script>
        document.getElementById('checkout-button').addEventListener('click', async () => {
          // Call the Netlify function
          const res = await fetch('/.netlify/functions/create-checkout-session', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ "priceID": "{{ .Params.priceID }}" })
          });

          console.log("PriceID: " + "{{ .Params.priceID }}")
          const data = await res.json();
          
          console.log("Data result: " + data.url);
          
          if (data.url) {
            // Redirect to Stripe Checkout
            window.location = data.url;
          } else {
            alert('Something went wrong creating the session.');
          }
        });
    </script>

{{ end }}
